<!DOCTYPE html>  
<html lang="pl">  
<head>  
<meta charset="UTF-8">  
<meta name="viewport" content="width=device-width, initial-scale=1.0">  
<title>Czat Online</title>  
<style>  
  body { font-family: Arial, sans-serif; background: #1e1e1e; color: #fff; margin: 0; display: flex; flex-direction: column; height: 100vh; }  
  #chat { flex: 1; overflow-y: auto; padding: 15px; border-bottom: 2px solid #333; }  
  #chat p { margin: 5px 0; line-height: 1.4; }  
  #chat span.nickname { font-weight: bold; margin-right: 5px; }  
  #messageForm { display: flex; padding: 10px; background: #2c2c2c; }  
  #messageForm input { flex: 1; padding: 10px; border: none; border-radius: 5px; margin-right: 5px; background: #333; color: #fff; }  
  #messageForm input::placeholder { color: #aaa; }  
  #messageForm button { padding: 10px 15px; border: none; border-radius: 5px; background: #4caf50; color: white; cursor: pointer; font-weight: bold; }  
  @media (max-width: 600px) {  
    #messageForm input, #messageForm button { font-size: 14px; padding: 8px; }  
  }  
</style>  
</head>  
<body>  
  
<div id="chat"></div>  
  
<form id="messageForm">  
  <input type="text" id="nickname" placeholder="Twój nick" required>  
  <input type="text" id="message" placeholder="Napisz wiadomość..." required>  
  <button type="submit">Wyślij</button>  
</form>  
  
<!-- Firebase (modular version) -->  
<script type="module">  
  import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";  
  import { getFirestore, collection, addDoc, query, orderBy, onSnapshot, serverTimestamp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js";  
  
  // 1️⃣ Wklej tutaj swoją konfigurację Firebase  
  const firebaseConfig = {  
    apiKey: "TU_WKLEJ_API_KEY",  
    authDomain: "TU_WKLEJ_AUTHDOMAIN",  
    projectId: "TU_WKLEJ_PROJECTID",  
    storageBucket: "TU_WKLEJ_STORAGEBUCKET",  
    messagingSenderId: "TU_WKLEJ_MESSAGINGID",  
    appId: "TU_WKLEJ_APPID",  
    measurementId: "TU_WKLEJ_MEASUREMENTID"  
  };  
  
  const app = initializeApp(firebaseConfig);  
  const db = getFirestore(app);  
  
  const chatDiv = document.getElementById('chat');  
  const messageForm = document.getElementById('messageForm');  
  const messageInput = document.getElementById('message');  
  const nicknameInput = document.getElementById('nickname');  
  
  function getRandomColor(nickname) {  
    let hash = 0;  
    for (let i = 0; i < nickname.length; i++) hash = nickname.charCodeAt(i) + ((hash << 5) - hash);  
    const c = (hash & 0x00FFFFFF).toString(16).toUpperCase();  
    return "#" + "00000".substring(0, 6 - c.length) + c;  
  }  
  
  const messagesRef = collection(db, "messages");  
  const q = query(messagesRef, orderBy("timestamp"));  
  
  onSnapshot(q, snapshot => {  
    chatDiv.innerHTML = "";  
    snapshot.forEach(doc => {  
      const data = doc.data();  
      const p = document.createElement('p');  
      const color = getRandomColor(data.nickname);  
      p.innerHTML = `<span class="nickname" style="color:${color}">${data.nickname}:</span> ${data.message}`;  
      chatDiv.appendChild(p);  
    });  
    chatDiv.scrollTop = chatDiv.scrollHeight;  
  });  
  
  messageForm.addEventListener('submit', async e => {  
    e.preventDefault();  
    const nickname = nicknameInput.value.trim();  
    const message = messageInput.value.trim();  
    if(nickname && message){  
      await addDoc(messagesRef, {  
        nickname: nickname,  
        message: message,  
        timestamp: serverTimestamp()  
      });  
      messageInput.value = "";  
    }  
  });  
</script>  
  
</body>  
</html>  
